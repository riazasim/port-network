<section>
  <div class="tw-flex-grow tw-flex tw-flex-col tw-gap-8">
    <div class="tw-flex min-lg:tw-justify-between sm:tw-justify-center lg:tw-flex-row max-lg:tw-flex-col tw-gap-4">
      <div class="tw-w-full tw-flex tw-gap-4 max-lg:tw-flex-col tw-items-center tw-justify-between">
        <div class="tw-flex tw-gap-8 tw-w-full">
          <h3 class="min-xl:tw-block max-xl:tw-hidden heading-4 tw-mr-5 tw-min-w-[250px]">Integration list</h3>
          <searchbar class="min-xl:tw-min-w-[600px]">
            <fa-icon leftIcon icon="search"></fa-icon>
            <input #searchIntegrationName input type="text" (keyup)="applyFilter($event.target, 'name')" placeholder="Search integration name">
            <div [style.visibility]="searchIntegrationName.value ? 'visible': 'hidden'" close (click)="searchIntegrationName.value=''; applyFilter({ value: '' }, 'name')">
              <fa-icon icon="close"></fa-icon>
            </div>
        </searchbar>
        </div>
        <div>
            <button type="button" class="btn btn-primary tw-min-w-[130px]" routerLink="../add">{{'button.add-name' | translate: { 'name': 'integrations.title' | translate | lowercase } }}</button>
        </div>
      </div>
    </div>
    <div *ngIf="(isLoading$ | async) || originalSource.length; else empty">
        <div table class="tw-w-full tw-shadow-lg tw-bg-white">
            <ng-scrollbar track="vertical" class="tw-min-h-[calc(100vh-200px)]">
              <table class="material-table no-wrap tw-overflow-hidden"
                    [class.loading]="(isLoading$ | async)" aria-label="Usage Table"
                    cdk-table [dataSource]="dataSource">
                    
                <ng-container cdkColumnDef="type">
                  <th cdk-header-cell *cdkHeaderCellDef scope="col">
                    <div>{{'integrations.integrations-type' | translate}}</div>
                  </th>
                  <td cdk-cell *cdkCellDef="let row">{{row.type || 'Yard'}}</td>
                </ng-container>

                <ng-container cdkColumnDef="name">
                  <th cdk-header-cell *cdkHeaderCellDef scope="col">
                    <div>{{'generics.naming' | translate}}</div>
                  </th>
                  <td cdk-cell *cdkCellDef="let row">{{row.name}}</td>
                </ng-container>
          
                <ng-container cdkColumnDef="partner">
                  <th cdk-header-cell *cdkHeaderCellDef scope="col">
                    <div>{{'generics.partner' | translate}}</div>
                  </th>
                  <td cdk-cell *cdkCellDef="let row">{{row.partner || '-'}}</td>
                </ng-container>
          
                <ng-container cdkColumnDef="locationName">
                  <th cdk-header-cell *cdkHeaderCellDef scope="col">
                    <div>{{'location.title' | translate}}</div>
                  </th>
                  <td cdk-cell *cdkCellDef="let row">{{row.locationName}}</td>
                </ng-container>
          
                <ng-container cdkColumnDef="apiKey">
                  <th cdk-header-cell *cdkHeaderCellDef scope="col">
                    <div>{{'integrations.api-key' | translate }}</div>
                  </th>
                  <td cdk-cell *cdkCellDef="let row">
                    <span class="tw-text-transparent text-blur">{{row.apiKey | slice: 0 : (row.apiKey.length / 1.5)}}</span>
                    <span>{{row.apiKey | slice: (row.apiKey.length / 1.5) : row.apiKey.length }}</span>
                    
                  </td>
                </ng-container>
  
                <ng-container cdkColumnDef="status">
                  <th cdk-header-cell *cdkHeaderCellDef scope="col">
                    <div>{{'generics.status' | translate }}</div>
                  </th>
                  <td cdk-cell *cdkCellDef="let row">-</td>
                </ng-container>
          
                <ng-container cdkColumnDef="actions">
                  <th cdk-header-cell *cdkHeaderCellDef scope="col">
                    <div>{{'generics.actions' | translate}}</div>
                  </th>
                  <td cdk-cell *cdkCellDef="let row" class="tw-flex tw-gap-4 tw-justify-center">
                    <img matTooltipClass="tw-drop-shadow-lg" matTooltipPosition="above" [matTooltip]="'button.copy' | translate"
                         src="assets/images/integration-copy.svg" class="tw-w-[19px] !tw-h-[18px] tw-cursor-pointer" (cdkCopyToClipboardCopied)="showNotificationAPIKey()" [cdkCopyToClipboard]="row.apiKey"/>
                    <fa-icon matTooltipClass="tw-drop-shadow-lg" matTooltipPosition="above" [matTooltip]="'button.edit' | translate" 
                             icon="eye" class="tw-text-primary tw-cursor-pointer" size="lg" [routerLink]="['../edit', row.id]"></fa-icon>
                    <fa-icon matTooltipClass="tw-drop-shadow-lg" matTooltipPosition="above" [matTooltip]="'button.delete' | translate" 
                             icon="xmark" class="tw-text-primary tw-cursor-pointer" size="lg" (click)="openDeleteModal(row)"></fa-icon>
                  </td>
                </ng-container>
          
                <!-- Header and Row Declarations -->
                <tr cdk-header-row *cdkHeaderRowDef="displayedColumns"></tr>
                <tr cdk-row *cdkRowDef="let row; columns: displayedColumns"></tr>
                <tr *cdkNoDataRow>
                  <td [colSpan]="displayedColumns.length">
                    <app-loader *ngIf="(isLoading$ | async)" [isContainer]="true" [fullScreen]="false"></app-loader>
                    <span
                      *ngIf="dataSource.length === 0 && !(isLoading$ | async)">{{'there-re-no-records' | translate}}</span>
                  </td>
                </tr>
              </table>
            </ng-scrollbar>
          </div>
    </div>  
  </div>

</section>

<ng-template #empty>
  <no-integration></no-integration>
</ng-template>